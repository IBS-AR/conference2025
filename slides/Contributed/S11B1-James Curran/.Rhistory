?merge_h
debug(build_stacked_blocks_flextable)
ftl = build_stacked_blocks_flextable(examiners.summary.df,
consensus.raw.df)
debug(make_block)
df
View(df)
header_df
View(header_df)
anzfss.df = read.csv("~/Dropbox/Work/2025/ANZFSS/members.csv")
nrow(anzfss.df)
ncol(anzfss.df)
tail(anzfss.df)
anzfss.df = read.csv("~/Dropbox/Work/2025/ANZFSS/members.csv")
chars = c(letters, LETTERS, 0:9, strsplit("!@#$%^&*()-_=+[]{};:,.?/<>", "")[[1]])
library(dplyr)
new.df = anzfss.df |>
mutate(full.name = paste0(X.First.Name, ' ', Last.Name)) |>
mutate(uid = row_number()) |>
mutate(pwd = replicate(
n(),
paste0(sample(chars, 8, replace = TRUE), collapse = "")
))
new.df = anzfss.df |>
mutate(full.name = paste0(X.First.Name, ' ', Last.Name)) |>
mutate(uid = row_number()) |>
mutate(pwd = replicate(
n(),
paste0(sample(chars, 8, replace = TRUE), collapse = "")
)) |>
select(pwd, uid, Email, full.name)
head(new.df)
chars = c(letters, LETTERS, 0:9, strsplit("!@#$%^&*-_=+.?", "")[[1]])
library(dplyr)
new.df = anzfss.df |>
mutate(full.name = paste0(X.First.Name, ' ', Last.Name)) |>
mutate(uid = row_number()) |>
mutate(pwd = replicate(
n(),
paste0(sample(chars, 8, replace = TRUE), collapse = "")
)) |>
select(pwd, uid, Email, full.name)
head(new.df)
library(dplyr)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = row_number()) |>
mutate(pwd = replicate(
n(),
paste0(sample(chars, 8, replace = TRUE), collapse = "")
)) |>
select(pwd, uid, Email, full.name)
head(new.df)
write.csv("~/Dropbox/Work/2025/ANZFSS/helios-members.csv")
write.csv(new.df, file = "~/Dropbox/Work/2025/ANZFSS/helios-members.csv")
write.csv(new.df, file = "~/Dropbox/Work/2025/ANZFSS/helios-members.csv", row.names = FALSE, col.names = FALSE)
?write.csv
write.table(new.df, file = "~/Dropbox/Work/2025/ANZFSS/helios-members.csv", sep = ',', row.names = FALSE, col.names = FALSE)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = row_number()) |>
mutate(pwd = rep('password', n())) |>
select(pwd, uid, Email, full.name)
head(new.df)
write.table(new.df, file = "~/Dropbox/Work/2025/ANZFSS/helios-members.csv", sep = ',', row.names = FALSE, col.names = FALSE)
library(dplyr)
library(stringr)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = str_pad(row_number(), width = 4, pad = "0")) |>
mutate(pwd = rep('password', n())) |>
select(pwd, uid, Email, full.name)
head(new.df)
library(stringr)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = str_pad(row_number(), width = 4, pad = "0")) |>
mutate(pwd = rep('password', n())) |>
select(pwd, uid, Email, full.name)
new.df = new.df |>
mutate(uid = sample(uid))
head(new.df)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = str_pad(row_number(), width = 4, pad = "0")) |>
mutate(pwd = rep('password', n())) |>
select(pwd, uid, Email, full.name)
head(new.df)
new.df = new.df |>
mutate(uid = sample(Letsample(uid))) |>
mutate(uid = paste0(uid, replicate(
n(),
sample(letters, 2, replace = TRUE)
)))
new.df = new.df |>
mutate(uid = sample(sample(uid))) |>
mutate(uid = paste0(uid, replicate(
n(),
sample(letters, 2, replace = TRUE)
)))
new.df = new.df |>
mutate(uid = sample(sample(uid))) |>
mutate(uid = paste0(uid, replicate(
n(),
paste0(sample(letters, 2, replace = TRUE), collapse = "")
)))
head(new.df)
new.df = new.df |>
mutate(uid = sample(sample(uid))) |>
mutate(uid = paste0(replicate(
n(),
paste0(sample(letters, 2, replace = TRUE), collapse = "")
), uid, collapse = ""))
head(new.df)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = str_pad(row_number(), width = 4, pad = "0")) |>
mutate(pwd = rep('password', n())) |>
select(pwd, uid, Email, full.name)
new.df = new.df |>
mutate(uid = sample(sample(uid))) |>
mutate(uid = paste0(replicate(
n(),
paste0(sample(letters, 2, replace = TRUE), collapse = "")
), uid, collapse = ""))
head(new.df)
new.df = anzfss.df |>
mutate(full.name = gsub('[ ]{2,}', ' ', paste0(X.First.Name, ' ', Last.Name))) |>
mutate(uid = str_pad(row_number(), width = 4, pad = "0")) |>
mutate(pwd = rep('password', n())) |>
select(pwd, uid, Email, full.name)
new.df = new.df |>
mutate(uid = sample(sample(uid))) |>
mutate(uid = paste0(replicate(
n(),
paste0(sample(letters, 2, replace = TRUE), collapse = "")
), uid))
head(new.df)
write.table(new.df, file = "~/Dropbox/Work/2025/ANZFSS/helios-members.csv", sep = ',', row.names = FALSE, col.names = FALSE)
.75*.75
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx")
library(readxl)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx")
library(readxl)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
names(surv.df)
library(dplyr)
names(surv.df) = tolower(surv.df)
names(surv.df)
names(surv.df)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
library(dplyr)
names(surv.df) = tolower(names(surv.df))
names(surv.df)
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`)
names(surv.df)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
library(dplyr)
names(surv.df) = tolower(names(surv.df))
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`) |>
rename(occupancy.pct = `occupancy\r\n(is the actual head count within the space)`) |>
rename(occupancy.ct = `occupancy unit count`)
boxplot(occupancy.pct ~ year, data = surv.df)
oc
surv.df$occupancy.pct
surv.df[734]
surv.df[734,]
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`) |>
rename(occupancy.pct = `occupancy\r\n(is the actual head count within the space)`) |>
rename(occupancy.ct = `occupancy unit count`) |>
mutate(occupancy.pct = occupancy.pct * 100) |>
filter(frequency > 0)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
library(dplyr)
names(surv.df) = tolower(names(surv.df))
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`) |>
rename(occupancy.pct = `occupancy\r\n(is the actual head count within the space)`) |>
rename(occupancy.ct = `occupancy unit count`) |>
mutate(occupancy.pct = occupancy.pct * 100) |>
filter(frequency > 0)
boxplot(occupancy.pct ~ year, data = surv.df)
names(surv.df) = tolower(names(surv.df))
names(surv.df)
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = year)) + geom_point()
library(ggplot2)
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = year)) + geom_point()
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year)) + geom_point()
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) + geom_point()
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) + geom_point() + geom_line()
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE, fullrange = TRUE)
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE)
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0)
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE)
names(surv.df)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
library(dplyr)
names(surv.df) = tolower(names(surv.df))
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`) |>
rename(occupancy.pct = `occupancy\r\n(is the actual head count within the space)`) |>
rename(occupancy.ct = `occupancy unit count`) |>
rename(room.type = `teaching/ non teaching`)
mutate(occupancy.pct = occupancy.pct * 100) |>
mutate(room.type = factor(room.type))
filter(frequency > 0)
boxplot(occupancy.pct ~ year, data = surv.df)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
library(dplyr)
names(surv.df) = tolower(names(surv.df))
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`) |>
rename(occupancy.pct = `occupancy\r\n(is the actual head count within the space)`) |>
rename(occupancy.ct = `occupancy unit count`) |>
rename(room.type = `teaching/ non teaching`)
surv.df = read_xlsx("~/Dropbox/Work/2025/tmp/Book2.xlsx",skip = 1)
library(dplyr)
names(surv.df) = tolower(names(surv.df))
surv.df = surv.df |>
rename(frequency = `frequency\r\n(auditors counting how many times the room is in use throughout 10hours 8am -6pm, mon-frid)`) |>
rename(occupancy.pct = `occupancy\r\n(is the actual head count within the space)`) |>
rename(occupancy.ct = `occupancy unit count`) |>
rename(room.type = `teaching/ non teaching`) |>
mutate(occupancy.pct = occupancy.pct * 100) |>
mutate(room.type = factor(room.type))
filter(frequency > 0)
boxplot(occupancy.pct ~ year, data = surv.df)
library(ggplot2)
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0)
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0) +
facet_grid(vars(room.type))
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0) +
facet_wrap(vars(room.type), scales = "free_x" )
g
?geom_smooth
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0) +
facet_wrap(vars(room.type), scales = "free_x" )
g
?case_when
surv.df = surv.df |>
mutate(capcity.fctr = factor(
case_when(
capcity <= 25 ~ 'small',
capcity > 25 & capacity < 100 ~ 'medium'
.default = 'large'
surv.df = surv.df |>
mutate(capcity.fctr = factor(
case_when(
capcity <= 25 ~ 'small',
capcity > 25 & capacity < 100 ~ 'medium',
.default = 'large'
)))
surv.df = surv.df |>
mutate(capacity.fctr = factor(
case_when(
capacity <= 25 ~ 'small',
capacity > 25 & capacity < 100 ~ 'medium',
.default = 'large'
)))
s
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0) +
facet_wrap(vars(capacity.fctr), scales = "free_x" )
g
library(ggplot2)
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.pct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0)
g
boxplot(occupancy.pct ~ year, data = surv.df,
ylab = "Occupancy (%)",
xlab = "Year")
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.pct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0) +
facet_wrap(vars(room.type), scales = "free_x" )
g
g = ggplot(data = surv.df, aes(x = capacity, y = occupancy.ct, color = as.factor(year))) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, fullrange = TRUE) +
geom_abline(slope = 1, intercept = 0) +
facet_wrap(vars(room.type), scales = "free_x" )
g
10^-2.5
10^2.5
dan.df = read.csv("Data Sheet Condensed.csv")
names(dan.df)
sum(is.na(dan.df))
library(dplyr)
missing.df = dan.df |>
summarise(across(everything(), ~ sum(is.na(.)))) |>
tidyr::pivot_longer(cols = everything(),
names_to = "variable",
values_to = "n_missing") %>%
filter(n_missing > 0)
missing.df
dan.df |>
group_by(Athlete_ID) |>
summarise(
n = n(),
n_dnf = sum(is.na(Time)),
pct_dnf = mean(is.na(Time)) * 100
)
dan.df |>
group_by(Gender) |>
summarise(
n = n(),
n_dnf = sum(is.na(Time)),
pct_dnf = mean(is.na(Time)) * 100
)
dan.df |>
group_by(Competition, Gender) |>
summarise(
n = n(),
n_dnf = sum(is.na(Time)),
pct_dnf = mean(is.na(Time)) * 100
)
library(dplyr)
penalty_factor = 1.25
dan.df = dan.df |>
mutate(
group_max = max(Time, na.rm = TRUE),
group_max = ifelse(is.finite(group_max), group_max, NA_real_),  # handle all-NA groups
time_adj  = if_else(is.na(Time), group_max * penalty_factor, Time),
.by = c(Gender, Competition)
) |>
select(-group_max)
dan.df = dan.df |>
mutate(round = case_match(
Round,
"16" ~ 1,
"quarter" ~ 2,
"semi" ~ 3,
"small final" ~ 4,
"final" ~ 5,
"1" ~ 1, ## deals with the odd coding for Tokyo
"2" ~ 3,
"3" ~ 5,
.default = NA_integer_
))
names(dan.df)
library(lme4)
fit1 = lmer(time_adj ~ CoM_Cluster_Variation_4 +
(1 + round_c | Competition) +
(1|Gender+Athlete_ID),
data = dan.df)
summary(fit1)
library(lme4)
fit1 = lmer(time_adj ~ CoM_Cluster_Variation_4 +
(1 + round | Competition) +
(1|Gender+Athlete_ID),
data = dan.df)
summary(fit1)
library(lme4)
fit1 <- lmer(
time_adj ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df
)
summary(fit1)
library(lme4)
fit1 <- lmer(
time_adj ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df
)
summary(fit1)
.4 * 12 / 10
dan.df$CoM_Cluster_Variation_4[dan.df$CoM_Cluster_Variation_4 == -1] = NA
dan.df$CoM_Cluster_Variation_4 = as.factor(dan.df$CoM_Cluster_Variation_4)
library(lme4)
fit1 <- lmer(
time_adj ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df
)
summary(fit1)
library(lme4)
fit1 <- lmer(
Split_10_to_top_RAW ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df
)
summary(fit1)
fit1 <- lmer(
Split_10_to_top_RAW ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df
)
fit2 <- lmer(
Split_10_to_top_RAW ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df
)
summary(fit2)
table(dat.df$Gender, dan.df$CoM_Cluster_Variation_4)
table(dan.df$Gender, dan.df$CoM_Cluster_Variation_4)
?lmer
dan.df$Gender
fit3 <- lmer(
Split_10_to_top_RAW ~ CoM_Cluster_Variation_4 + Gender +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df,
subset = dan.df$Gender == 'Men'
)
fit3 <- lmer(
Split_10_to_top_RAW ~ CoM_Cluster_Variation_4 +
(1 | Athlete_ID) +  # repeated measures across athletes
(1 | Competition) + # baseline differences between competitions
(1 | Competition:round),  # adjust for rounds within each competition
data = dan.df,
subset = dan.df$Gender == 'Men'
)
summary(fit3)
fit4 <- lmer(
Split_10_to_top_RAW ~ CoM_Cluster_Variation_4 +
(1 | Athlete_ID) + (1 | Competition:round),
data = subset(dan.df, Gender == "Men")
)
summary(fit4)
convert_qmd_to_rnw <- function(qmd_file, rnw_file) {
lines = readLines(qmd_file)
# Remove YAML (everything between --- pairs)
yaml_start = which(lines == "---")[1]
yaml_end   = which(lines == "---")[2]
if (!is.na(yaml_start) && !is.na(yaml_end)) {
lines = lines[-(yaml_start:yaml_end)]
}
# Replace markdown headers (# -> \section)
lines = gsub("^# (.*)", "\\\\section{\\1}", lines)
lines = gsub("^## (.*)", "\\\\subsection{\\1}", lines)
# Convert code chunks ```{r} -> <<>>=
lines = gsub("^```\\{r.*\\}", "<<>>=", lines)
lines = gsub("^```$", "@", lines)
# Add LaTeX preamble and end
header = c(
"\\documentclass{article}",
"\\begin{document}"
)
footer = "\\end{document}"
writeLines(c(header, lines, footer), rnw_file)
message("âœ… Wrote ", rnw_file)
}
pwd()
getwd()
setwd("~/Library/CloudStorage/Dropbox/Talks/2025/IBS-AR")
convert_qmd_to_rnw("GenstatMarkdown.qmd", "GenstatMarkdown.Rnw")
installed.packages()
?installed.packages
options()
o = options()
o$max.print
df = installed.packages()
df
df$[,1]
df
str(df)
df[[1,]]
df[[1,]
]
df[,1]
